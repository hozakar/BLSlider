/* 
 *  BLSlider v0.1.0
 *  https://github.com/hozakar/BLSlider
 *
 *  Copyright 2014, Hakan Ozakar <hozakar@gmail.com>
 *  http://beltslib.net
 *
 *  CC0 1.0 Universal Licence
 *  https://creativecommons.org/publicdomain/zero/1.0/
 */
!function(a){"use strict";var b={},c=999;navigator.appName.indexOf("Internet Explorer")>-1&&(c=parseInt(navigator.appVersion.split("MSIE ")[1].split(".")[0])),b.PrepDOM=function(b,d){this.el=b,this.params=d,a(b).data("style",b.getAttribute("style")),a(b).css("position")&&"static"!==a(b).css("position")||a(b).css("position","relative");var e=[];a(b).children().each(function(){e.push(a(this).clone()[0])}),this.slides=e,a(b).html('<div class="BLSliderContainer"></div>'),8>=c&&a(b).find(".BLSliderContainer").addClass("ie8"),a(b).find(".BLSliderContainer").css({position:"relative",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}),this.createControls(),this.startTracker()},b.PrepDOM.prototype.getSlides=function(){return this.slides},b.PrepDOM.prototype.kill=function(b,c){var e=this.el;for(d[c].stop(),e.setAttribute("style",a(e).data("style")||""),a(e).html("");b.length>0;)a(b.shift()).clone(!0).appendTo(e);d[c]=null,a(e).data("BLSliderControllerId",null),a(e).data("BLSliderSlides",null)},b.PrepDOM.prototype.createControls=function(){var b=this.el,c=this.params,d=a(b).children(".BLSliderContainer");if(c.autoPlay&&c.pauseOnHover&&d.hover(function(){a(b).BLSStop()}).mouseleave(function(){a(b).BLSPlay()}),"never"!==c.showNavigation||"never"!==c.showPagination){if("never"!==c.showNavigation&&(d.append('<div class="BLSlider-prev" data-role="prev"></div><div class="BLSlider-next" data-role="next"></div>'),"always"===c.showNavigation&&a(".BLSlider-prev, .BLSlider-next").addClass("show-always")),"never"!==c.showPagination){d.append('<div class="BLSlider-buttons"><ul class="BLSliderButtonList"></ul></div>');for(var e=0,f=this.slides.length;f>e;e++)d.find(".BLSliderButtonList").append('<li class="BLSliderControlButton" data-slide-id="'+e+'" data-role="moveTo"></li>');"always"===c.showPagination&&a(".BLSlider-buttons").addClass("show-always")}d.on("click",function(c){var d=c.toElement||c.relatedTarget||c.target||!1;if(!d)return!1;switch(a(d).data("role")){case"prev":a(b).BLSPrev();break;case"next":a(b).BLSNext();break;case"moveTo":var e=parseInt(a(d).data("slide-id"))||0;a(b).BLSMoveTo(e)}})}},b.PrepDOM.prototype.startTracker=function(){function b(){if(i.start.x){var b=i.move.x-i.start.x;if(b){var c=b/Math.abs(b);b=Math.abs(b);var e=i.move.t-i.start.t;b>k&&(c>0?a(j).BLSPrev():a(j).BLSNext(),d()),e>l&&d()}}}function d(){i={start:{},move:{}}}function e(a){var b=a.button===(8>=c?1:0);b&&(h(a),i.start={x:a.clientX||a.originalEvent.changedTouches[0].pageX,t:8>=c?+new Date:Date.now()})}function f(a){h(a),d()}function g(a){i.start.x&&(h(a),i.move={x:a.clientX||a.originalEvent.changedTouches[0].pageX,t:8>=c?+new Date:Date.now()},b())}function h(a){a.preventDefault?a.preventDefault():a.returnValue=!1}var i,j=this.el,k=50,l=100;d(),a(j).on("mousedown",e).on("mouseup",f).on("mousemove",g).on("touchstart",e).on("touchend",f).on("touchmove",g)},b.Timer=function(a,b){this.timerHandle=!1,this.el=a,this.params=b},b.Timer.prototype.open=function(){this.timerHandle&&clearInterval(this.timerHandle),this.timerHandle=!1;var b=this.el;this.timerHandle=setInterval(function(){a(b).BLSNext()},this.params.interval+this.params.duration)},b.Timer.prototype.close=function(){clearInterval(this.timerHandle),this.timerHandle=!1},b.Move=function(a,b){this.el=a,this.params=b,this.animType="slide",this.js=!1,10>c&&(this.js=!0),"undefined"!=typeof this[b.animation.toLowerCase()]&&(this.animType=b.animation.toLowerCase())},b.Move.prototype.to=function(b,c){function d(){var c=a(e).data("BLSliderSlides")[b],d=a(e).find(".BLSlider-current-slide");if(!d.length){var d=a('<div class="BLSlider-current-slide"></div>').appendTo(a(e).children(".BLSliderContainer"));return h.animFuncs.setSlide(d),d.append(a(c).clone()),!0}return!1}var e=this.el,f=this.animType,g=this.params,h=this;if(!d()){var i=a(a(e).data("BLSliderSlides")[b]).data("animation")||this.animType;"undefined"!=typeof this[i.toLowerCase()]&&(f=i.toLowerCase()),setTimeout(function(){h[f](b,c)},g.delay)}},b.Move.prototype.execute=function(b,c){var d=this.el,e=this.params;"object"!=typeof c&&(c={}),c=a.extend({next:{before:{left:0},after:{left:0}},current:{after:{left:0}},trans:{}},c);var f=this.animFuncs.getSlides(d,c.next.before);f.next.append(a(d).data("BLSliderSlides")[b]),this.js||(f.current.css(c.trans),f.next.css(c.trans)),this.animFuncs.shiftSlides(f,e.interval,c.current.after,c.next.after,this.js)},b.Move.prototype.slide=function(a,b){var c=this.params,d={next:{before:{left:100*b+"%"},after:{left:0}},current:{after:{left:-100*b+"%"}},trans:arguments[2]?{}:this.animFuncs.setPrefix("-pre-transition : left "+c.interval+"ms "+c.easing)};this.execute(a,d)},b.Move.prototype.fade=function(a,b){var c=this.params,d={next:{before:{opacity:0,zIndex:9-b},after:{opacity:1}},current:{after:{opacity:0}},trans:arguments[2]?{}:this.animFuncs.setPrefix("-pre-transition : opacity "+c.interval+"ms "+c.easing)};this.execute(a,d)},b.Move.prototype.scale=function(a,b){var c=this.params,d={next:{before:this.animFuncs.setPrefix("opacity: 0; z-index: "+(9-b)+"; -pre-transform : scale("+(10-8*b)/10+")"),after:this.animFuncs.setPrefix("opacity: 1; -pre-transform: scale(1)")},current:{after:this.animFuncs.setPrefix("opacity: 0; -pre-transform: scale("+(10+6*b)/10+")")},trans:this.animFuncs.setPrefix("-pre-transition : -pre-transform "+c.interval+"ms "+c.easing+", opacity "+c.interval/1.25+"ms "+c.easing)};this.execute(a,d)},b.Move.prototype.animFuncs={setPrefix:function(a){function b(a,b){a=a.split(":"),2===a.length&&(b[a[0].split(" ").join("")]=a[1])}var c={},d=["-webkit-","-moz-","-ms-","-o-",""];if(a){a=a.split(";");for(var e=0,f=a.length;f>e;e++)if(a[e])if(a[e].indexOf("-pre-")>-1)for(var g=0,f=d.length;f>g;g++){var h=a[e].replace(/-pre-/g,d[g]);b(h,c)}else b(a[e],c)}return c},shiftSlides:function(a,b,c,d,f){f?setTimeout(function(){a.current.animate(c,b),a.next.animate(d,b)},e/2):setTimeout(function(){a.current.css(c),a.next.css(d)},e/2);var g=this;setTimeout(function(){a.current.remove(),a.next.attr("class","BLSlider-current-slide").css(g.setPrefix("-pre-transition : none"))},b)},setSlide:function(b,c){c=c||{},b.css(a.extend({position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",zIndex:9},c))},getSlides:function(b,c){var d={next:a('<div class="BLSlider-next-slide"></div>').appendTo(a(b).children(".BLSliderContainer")),current:a(b).find(".BLSlider-current-slide")};return this.setSlide(d.current),this.setSlide(d.next,c),d}};var d=[],e=100,f=function(c,f){var g=d.length,h=0,i=!1;f.onBeforeInit(a(c));var j=new b.PrepDOM(c,f),k=new b.Move(c,f),l=new b.Timer(c,f);this.slides=j.getSlides(),this.next=function(){var a=(h+1)%this.slides.length;this.moveTo(a,1)},this.prev=function(){var a=(h-1+this.slides.length)%this.slides.length;this.moveTo(a,-1)},this.moveTo=function(b,d){return i?!1:void(b===h&&a(c).find(".BLSlider-current-slide").length||(i=!0,f.onBeforeMove(a(c).find(".BLSlider-current-slide").children()),d=d||(b-h)/Math.max(1,Math.abs(b-h)),k.to(b,d),f.autoPlay&&this.play(),h=b,setTimeout(function(){i=!1,a(c).find(".BLSliderControlButton").removeClass("selected"),a(c).find(".BLSliderControlButton:nth-child("+(h+1)+")").addClass("selected"),f.onAfterMove(a(c).find(".BLSlider-current-slide").children())},f.interval+f.delay+e)))},this.play=function(){l.open()},this.stop=function(){l.close()},this.kill=function(){f.onBeforeKill(a(c)),j.kill(this.slides,g),f.onAfterKill(a(c))},a(c).data("BLSliderControllerId",g),a(c).data("BLSliderSlides",this.slides),f.onAfterInit(a(c)),this.moveTo(h)};a.fn.BLSlider=function(b){for(var c={interval:800,duration:8e3,delay:0,animation:"slide",easing:"ease-in-out",autoPlay:!0,pauseOnHover:!0,showNavigation:"hover",showPagination:"hover",onBeforeMove:function(){},onAfterMove:function(){},onBeforeInit:function(){},onAfterInit:function(){},onBeforeKill:function(){},onAfterKill:function(){}},e=a.extend(c,b),g=0,h=this.length;h>g;g++)"number"!=typeof a(this[g]).data("BLSliderControllerId")&&d.push(new f(this[g],e));return this},b.validControllers=function(b,c,e){for(var f=[],g=0,h=b.length;h>g;g++){var i=a(b[g]).data("BLSliderControllerId");i>=0&&d[i]&&f.push(d[i])}for(var g=0,h=f.length;h>g;g++)f[g][c](e)},a.fn.BLSNext=function(){b.validControllers(this,"next")},a.fn.BLSPrev=function(){b.validControllers(this,"prev")},a.fn.BLSMoveTo=function(a){"undefined"!=typeof a&&b.validControllers(this,"moveTo",a)},a.fn.BLSPlay=function(){b.validControllers(this,"play")},a.fn.BLSStop=function(){b.validControllers(this,"stop")},a.fn.BLSKill=function(){b.validControllers(this,"kill")}}(jQuery);